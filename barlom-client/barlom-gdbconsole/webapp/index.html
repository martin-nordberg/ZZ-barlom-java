<!DOCTYPE html>
<html>

<head lang="en">

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1">

    <title>Barlom-GDB Console</title>

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.1.1.js"
            integrity="sha256-16cdPddA6VdVInumRGo6IbivbERE8p7CQR3HzTBuELA="
            crossorigin="anonymous"></script>

    <!-- riot.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/riot/2.6.4/riot+compiler.min.js"></script>

    <!-- custom elements -->
    <script src="customelements/vertextyperow.es6.js"></script>

</head>

<body id="console-id">

<h1>Barlom-GDB Console</h1>

<a href="/barlomgdbconsole/exit">Exit</a>

<div id="content">
    <a href="#vertextypes">Vertex Types</a>
    <!-- Filled dynamically according to hash tag. -->
</div>

</body>

<script>

    function loadVertexType( uuid ) {

        $.getJSON( '/barlomgdbconsolecontent/vertextypes/' + uuid )
                .done(
                        function ( vertextype ) {
                            var content = `<barlom-gdb-vertextyperow uuid="${vertextype.uuid}" name="${vertextype.name}"></barlom-gdb-vertextyperow>`;
                            $( '#content' ).html( content );
                        }
                )
                .fail(
                        function ( jqxhr, textStatus, error ) {
                            var err = textStatus + ", " + error;
                            alert( "Request Failed: " + err );
                        }
                );

    }

    function loadVertexTypes() {

        $.getJSON( '/barlomgdbconsolecontent/vertextypes' )
                .done(
                        function ( response ) {
                            var content = "";
                            for ( let vertextype of response.data ) {
                                content += `<barlom-gdb-vertextyperow uuid="${vertextype.uuid}" name="${vertextype.name}"></barlom-gdb-vertextyperow>`;
                            }
                            $( '#content' ).html( content );
                        }
                )
                .fail(
                        function ( jqxhr, textStatus, error ) {
                            var err = textStatus + ", " + error;
                            alert( "Request Failed: " + err );
                        }
                );

    }

    $(
            function () {
                // Vertex types
                riot.route( '/vertextypes/*', loadVertexType );
                riot.route( '/vertextypes', loadVertexTypes );

                // Start routing
                riot.route.start( true );
            }
    );

</script>

</html>